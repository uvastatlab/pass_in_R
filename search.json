[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Power and Sample Size in R",
    "section": "",
    "text": "Preface\nThis online book contains examples of power and sample size calculations in R.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "t_tests.html",
    "href": "t_tests.html",
    "title": "1  T tests",
    "section": "",
    "text": "1.1 Two sample t-test\nFor sample size estimation based on power, we need the following:",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>T tests</span>"
    ]
  },
  {
    "objectID": "t_tests.html#two-sample-t-test",
    "href": "t_tests.html#two-sample-t-test",
    "title": "1  T tests",
    "section": "",
    "text": "hypothesized difference in means (effect size)\npopulation standard deviation\npower of test\nsignificance level of test\ndirection of test: one or two-sided\n\n\n1.1.1 Example\nWe wish to run an experiment to test if the mean price of what male and female students pay at a library coffee shop is different. Our null hypothesis is no difference. We want to sample enough students to detect a difference of at least 75 cents. We’re not sure which group pays more, so we’ll do a two-sided test. Assume the following:\n\ntrue difference is 0.75 cents\npopulation standard deviation is $2.25.\nwe desire 0.9 power\nour significance level will be 0.05\nthis will be two-sided test\n\nUsing base R (R Core Team 2025):\n\npower.t.test(delta = 0.75, sd = 2.25, sig.level = 0.05, power = 0.9,\n             alternative = \"two.sided\")\n\n\n     Two-sample t test power calculation \n\n              n = 190.0991\n          delta = 0.75\n             sd = 2.25\n      sig.level = 0.05\n          power = 0.9\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n\n\nWe should plan to observe 191 in each group.\nUsing the pwr package (Champely 2020), we must express effect size as Cohen’s d: difference between the means divided by the population (or pooled) standard deviation.\n\nlibrary(pwr)\npwr.t.test(d = 0.75/2.25, sig.level = 0.05, power = 0.9, \n           alternative = \"two.sided\")\n\n\n     Two-sample t test power calculation \n\n              n = 190.0991\n              d = 0.3333333\n      sig.level = 0.05\n          power = 0.9\n    alternative = two.sided\n\nNOTE: n is number in *each* group",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>T tests</span>"
    ]
  },
  {
    "objectID": "t_tests.html#paired-t-test",
    "href": "t_tests.html#paired-t-test",
    "title": "1  T tests",
    "section": "1.2 Paired t-test",
    "text": "1.2 Paired t-test\nFor sample size estimation based on power, we need the following:\n\nhypothesized difference between pairs (effect size)\nstandard deviation of differences\npower of test\nsignificance level of test\ndirection of test: one or two-sided\n\n\n1.2.1 Example\nWe wish to run an experiment to see if an ultra-heavy rope-jumping program reduces 40-yard dash times. We will recruit young men ages 18 - 25 and measure their 40-yard dash time in seconds before the program and after. We’ll use a paired t-test to see if the difference in times is greater than 0 (before - after). We want to sample enough subjects to detect a difference of 0.08 seconds. Assume the following:\n\nhypothesized difference of 0.08\nstandard deviation of differences is 0.25\nwe desire 0.9 power\nsignificance level of 0.05\none-sided test since we assume dash times will only get faster\n\nUsing base R:\n\npower.t.test(delta = 0.08, sd = 0.25, sig.level = 0.05, power = 0.9, \n             type = \"paired\", alternative = \"one.sided\")\n\n\n     Paired t test power calculation \n\n              n = 85.00257\n          delta = 0.08\n             sd = 0.25\n      sig.level = 0.05\n          power = 0.9\n    alternative = one.sided\n\nNOTE: n is number of *pairs*, sd is std.dev. of *differences* within pairs\n\n\nWe should plan to sample at least 86 subjects.\nUsing the pwr package, we need to express the effect size as Cohen’s d: difference in pairs divided by the standard deviation of the differences.\n\nlibrary(pwr)\npwr.t.test(power = 0.9, d = 0.08 / 0.25,\n           type = \"paired\", alternative = \"greater\")\n\n\n     Paired t test power calculation \n\n              n = 85.00256\n              d = 0.32\n      sig.level = 0.05\n          power = 0.9\n    alternative = greater\n\nNOTE: n is number of *pairs*\n\n\n\n\n\n\nChampely, Stephane. 2020. Pwr: Basic Functions for Power Analysis. https://doi.org/10.32614/CRAN.package.pwr.\n\n\nR Core Team. 2025. R: A Language and Environment for Statistical Computing. Vienna, Austria: R Foundation for Statistical Computing. https://www.R-project.org/.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>T tests</span>"
    ]
  },
  {
    "objectID": "p_tests.html",
    "href": "p_tests.html",
    "title": "2  Proportion tests",
    "section": "",
    "text": "2.1 Two-sample proportion test\nFor sample size estimation based on power, we need the following:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Proportion tests</span>"
    ]
  },
  {
    "objectID": "p_tests.html#two-sample-proportion-test",
    "href": "p_tests.html#two-sample-proportion-test",
    "title": "2  Proportion tests",
    "section": "",
    "text": "proportion in one group\nproportion in other group\npower of test\nsignificance level of test\ndirection of test: one or two-sided\n\n\n2.1.1 Example\nWe wish to plan an experiment to test if there is a difference in the proportion of male and female college undergraduate students who floss daily. Our null hypothesis is no difference in the proportion that answer yes. We want to sample enough students to detect a difference of at least 5%. Assume the following:\n\nproportion of one group is 0.30\nproportion of the other group is 0.25\npower of 0.9\nsignificance level of 0.05\ntwo-sided test\n\nUsing base R (R Core Team 2025):\n\npower.prop.test(p1 = 0.30, p2 = 0.25, sig.level = 0.05, power = 0.9, \n                alternative = \"two.sided\")\n\n\n     Two-sample comparison of proportions power calculation \n\n              n = 1673.856\n             p1 = 0.3\n             p2 = 0.25\n      sig.level = 0.05\n          power = 0.9\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n\n\nWe need to observe 1674 students in each group.\nNotice the sample size decreases if assume proportions are closer to 0 or 1. For example, assume 0.05 in one group and 0.10 for the other.\n\npower.prop.test(p1 = 0.05, p2 = 0.10, sig.level = 0.05, power = 0.9, \n                alternative = \"two.sided\")\n\n\n     Two-sample comparison of proportions power calculation \n\n              n = 581.0821\n             p1 = 0.05\n             p2 = 0.1\n      sig.level = 0.05\n          power = 0.9\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n\n\nNow we need to observe 582 in each group.\nUsing the pwr package (Champely 2020), we need to express the difference in proportions as an effect size using ES.h():\n\nlibrary(pwr)\npwr.2p.test(h = ES.h(p1 = 0.05, p2 = 0.10), sig.level = 0.05, power = 0.9,\n            alternative = \"two.sided\")\n\n\n     Difference of proportion power calculation for binomial distribution (arcsine transformation) \n\n              h = 0.1924743\n              n = 567.2579\n      sig.level = 0.05\n          power = 0.9\n    alternative = two.sided\n\nNOTE: same sample sizes\n\n\nWe need to observe 568 in each group. The result does not match the base R function because they each calculate effect size differently.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Proportion tests</span>"
    ]
  },
  {
    "objectID": "p_tests.html#difference-in-proportions",
    "href": "p_tests.html#difference-in-proportions",
    "title": "2  Proportion tests",
    "section": "2.2 Difference in proportions",
    "text": "2.2 Difference in proportions\nFor sample size estimation based on precision, we need the following:\n\nproportion in one group\nproportion in other group\ndesired width of confidence interval\n\n\n2.2.1 Example\nWe wish to plan an experiment to test if there is a difference in the proportion of male and female college undergraduate students who floss daily. If there truly is a difference of 0.05 in the population, we would like to estimate it within 0.025. That implies estimating a confidence interval with a width of 0.05. Assume the following:\n\nproportion of one group is 0.30\nproportion of the other group is 0.25\nconfidence interval width of 0.05\n\nUsing the prec_riskdiff() function from the presize package (Haynes et al. 2021), we can calculate this as follows. (The Newcombe method is the default method.)\n\nlibrary(presize)\nprec_riskdiff(p1 = 0.30, p2 = 0.25, conf.width = 0.05, method = \"newcombe\")\n\n\n     sample size for a risk difference with newcombe confidence interval \n\n   p1   p2       n1       n2     ntot r delta        lwr        upr conf.width\n1 0.3 0.25 2441.299 2441.299 4882.598 1  0.05 0.02495861 0.07495861       0.05\n  conf.level\n1       0.95\n\n\nTo estimate a difference in proportions with this precision, assuming the group proportions are each 0.30 and 0.25, we need to sample 2442 subjects in each group.\nOnce again, assumed proportions closer to 0 or 1 require smaller samples:\n\nprec_riskdiff(p1 = 0.05, p2 = 0.10, conf.width = 0.05, method = \"newcombe\")\n\n\n     sample size for a risk difference with newcombe confidence interval \n\n    p1  p2       n1       n2     ntot r delta         lwr         upr\n1 0.05 0.1 860.9835 860.9835 1721.967 1 -0.05 -0.07525428 -0.02525428\n  conf.width conf.level\n1       0.05       0.95\n\n\nLarger confidence widths also require smaller sample sizes. For example, to estimate a difference in proportions within 0.05 (i.e., confidence width of 0.1):\n\nprec_riskdiff(p1 = 0.05, p2 = 0.10, conf.width = 0.1, method = \"newcombe\")\n\n\n     sample size for a risk difference with newcombe confidence interval \n\n    p1  p2       n1       n2     ntot r delta        lwr           upr\n1 0.05 0.1 225.9885 225.9885 451.9769 1 -0.05 -0.1008756 -0.0008756156\n  conf.width conf.level\n1        0.1       0.95\n\n\n\n\n\n\nChampely, Stephane. 2020. Pwr: Basic Functions for Power Analysis. https://doi.org/10.32614/CRAN.package.pwr.\n\n\nHaynes, Alan G., Armando Lenz, Odile Stalder, and Andreas Limacher. 2021. “‘Presize‘: An r-Package for Precision-Based Sample Size Calculation in Clinical Research.” Journal of Open Source Software 6 (60): 3118. https://doi.org/10.21105/joss.03118.\n\n\nR Core Team. 2025. R: A Language and Environment for Statistical Computing. Vienna, Austria: R Foundation for Statistical Computing. https://www.R-project.org/.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Proportion tests</span>"
    ]
  },
  {
    "objectID": "anova.html",
    "href": "anova.html",
    "title": "3  ANOVA",
    "section": "",
    "text": "3.1 One-way ANOVA",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>ANOVA</span>"
    ]
  },
  {
    "objectID": "anova.html#two-way-anova",
    "href": "anova.html#two-way-anova",
    "title": "3  ANOVA",
    "section": "3.2 Two-way ANOVA",
    "text": "3.2 Two-way ANOVA",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>ANOVA</span>"
    ]
  },
  {
    "objectID": "anova.html#ancova",
    "href": "anova.html#ancova",
    "title": "3  ANOVA",
    "section": "3.3 ANCOVA",
    "text": "3.3 ANCOVA",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>ANOVA</span>"
    ]
  },
  {
    "objectID": "regression.html",
    "href": "regression.html",
    "title": "4  Regression",
    "section": "",
    "text": "4.1 Multiple Regression",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Regression</span>"
    ]
  },
  {
    "objectID": "regression.html#partial-f-tests",
    "href": "regression.html#partial-f-tests",
    "title": "4  Regression",
    "section": "4.2 Partial F Tests",
    "text": "4.2 Partial F Tests",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Regression</span>"
    ]
  },
  {
    "objectID": "regression.html#logistic-regression",
    "href": "regression.html#logistic-regression",
    "title": "4  Regression",
    "section": "4.3 Logistic Regression",
    "text": "4.3 Logistic Regression",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Regression</span>"
    ]
  },
  {
    "objectID": "regression.html#poisson-regression",
    "href": "regression.html#poisson-regression",
    "title": "4  Regression",
    "section": "4.4 Poisson Regression",
    "text": "4.4 Poisson Regression",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Regression</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Champely, Stephane. 2020. Pwr: Basic Functions for Power\nAnalysis. https://doi.org/10.32614/CRAN.package.pwr.\n\n\nHaynes, Alan G., Armando Lenz, Odile Stalder, and Andreas Limacher.\n2021. “‘Presize‘: An r-Package for Precision-Based Sample Size\nCalculation in Clinical Research.” Journal of Open Source\nSoftware 6 (60): 3118. https://doi.org/10.21105/joss.03118.\n\n\nR Core Team. 2025. R: A Language and Environment for Statistical\nComputing. Vienna, Austria: R Foundation for Statistical Computing.\nhttps://www.R-project.org/.",
    "crumbs": [
      "References"
    ]
  }
]